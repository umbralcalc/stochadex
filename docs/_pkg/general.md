---
title: "general"
logo: true
---
<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# general

```go
import "github.com/umbralcalc/stochadex/pkg/general"
```

Package general provides general\-purpose iteration functions and utilities for stochadex simulations. It includes data transformation functions, aggregation utilities, and flexible iteration patterns that can be composed to create complex simulation behaviors.

Key Features:

- Data transformation and reduction functions
- Flexible function\-based iterations
- Parameter value management and copying
- Constant value generation and propagation
- Cumulative value tracking and accumulation
- Embedded simulation run support
- History\-based value extraction
- Event\-driven value changes
- Collection and sorting utilities
- Weighted resampling algorithms

Design Philosophy: This package emphasizes composition and flexibility, providing building blocks that can be combined to create sophisticated simulation behaviors. Functions are designed to be pure \(stateless\) and composable, enabling complex data processing pipelines within simulations.

Usage Patterns:

- Data preprocessing and feature engineering
- Custom aggregation and transformation logic
- Parameter management and value propagation
- Event\-driven simulation dynamics
- Multi\-scale simulation coordination

Package general provides general\-purpose iteration functions and utilities for stochadex simulations. It includes data transformation functions, aggregation utilities, and flexible iteration patterns that can be composed to create complex simulation behaviors.

Key Features:

- Data transformation and reduction functions
- Flexible function\-based iterations
- Parameter value management and copying
- Constant value generation and propagation
- Cumulative value tracking and accumulation
- Embedded simulation run support
- History\-based value extraction
- Event\-driven value changes
- Collection and sorting utilities
- Weighted resampling algorithms

Design Philosophy: This package emphasizes composition and flexibility, providing building blocks that can be combined to create sophisticated simulation behaviors. Functions are designed to be pure \(stateless\) and composable, enabling complex data processing pipelines within simulations.

Usage Patterns:

- Data preprocessing and feature engineering
- Custom aggregation and transformation logic
- Parameter management and value propagation
- Event\-driven simulation dynamics
- Multi\-scale simulation coordination

Package general provides general\-purpose iteration functions and utilities for stochadex simulations. It includes data transformation functions, aggregation utilities, and flexible iteration patterns that can be composed to create complex simulation behaviors.

Key Features:

- Data transformation and reduction functions
- Flexible function\-based iterations
- Parameter value management and copying
- Constant value generation and propagation
- Cumulative value tracking and accumulation
- Embedded simulation run support
- History\-based value extraction
- Event\-driven value changes
- Collection and sorting utilities
- Weighted resampling algorithms

Design Philosophy: This package emphasizes composition and flexibility, providing building blocks that can be combined to create sophisticated simulation behaviors. Functions are designed to be pure \(stateless\) and composable, enabling complex data processing pipelines within simulations.

Usage Patterns:

- Data preprocessing and feature engineering
- Custom aggregation and transformation logic
- Parameter management and value propagation
- Event\-driven simulation dynamics
- Multi\-scale simulation coordination

Package general provides general\-purpose iteration functions and utilities for stochadex simulations. It includes data transformation functions, aggregation utilities, and flexible iteration patterns that can be composed to create complex simulation behaviors.

Key Features:

- Data transformation and reduction functions
- Flexible function\-based iterations
- Parameter value management and copying
- Constant value generation and propagation
- Cumulative value tracking and accumulation
- Embedded simulation run support
- History\-based value extraction
- Event\-driven value changes
- Collection and sorting utilities
- Weighted resampling algorithms

Design Philosophy: This package emphasizes composition and flexibility, providing building blocks that can be combined to create sophisticated simulation behaviors. Functions are designed to be pure \(stateless\) and composable, enabling complex data processing pipelines within simulations.

Usage Patterns:

- Data preprocessing and feature engineering
- Custom aggregation and transformation logic
- Parameter management and value propagation
- Event\-driven simulation dynamics
- Multi\-scale simulation coordination

Package general provides general\-purpose iteration functions and utilities for stochadex simulations. It includes data transformation functions, aggregation utilities, and flexible iteration patterns that can be composed to create complex simulation behaviors.

Key Features:

- Data transformation and reduction functions
- Flexible function\-based iterations
- Parameter value management and copying
- Constant value generation and propagation
- Cumulative value tracking and accumulation
- Embedded simulation run support
- History\-based value extraction
- Event\-driven value changes
- Collection and sorting utilities
- Weighted resampling algorithms

Design Philosophy: This package emphasizes composition and flexibility, providing building blocks that can be combined to create sophisticated simulation behaviors. Functions are designed to be pure \(stateless\) and composable, enabling complex data processing pipelines within simulations.

Usage Patterns:

- Data preprocessing and feature engineering
- Custom aggregation and transformation logic
- Parameter management and value propagation
- Event\-driven simulation dynamics
- Multi\-scale simulation coordination

## Index

- [func AppendFloatToKey\(key string, value float64, precision int\) string](<#AppendFloatToKey>)
- [func CountAggregation\(defaultValues \[\]float64, outputIndexByGroup map\[string\]int, groupings map\[string\]\[\]float64, weightings map\[string\]\[\]float64\) \[\]float64](<#CountAggregation>)
- [func DataValuesFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, stateHistoryDepthIndex int\) \[\]float64](<#DataValuesFunction>)
- [func DataValuesVarianceFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, stateHistoryDepthIndex int\) \[\]float64](<#DataValuesVarianceFunction>)
- [func FloatTupleToKey\(tuple \[\]float64, precision int\) string](<#FloatTupleToKey>)
- [func MaxAggregation\(defaultValues \[\]float64, outputIndexByGroup map\[string\]int, groupings map\[string\]\[\]float64, weightings map\[string\]\[\]float64\) \[\]float64](<#MaxAggregation>)
- [func MeanAggregation\(defaultValues \[\]float64, outputIndexByGroup map\[string\]int, groupings map\[string\]\[\]float64, weightings map\[string\]\[\]float64\) \[\]float64](<#MeanAggregation>)
- [func MinAggregation\(defaultValues \[\]float64, outputIndexByGroup map\[string\]int, groupings map\[string\]\[\]float64, weightings map\[string\]\[\]float64\) \[\]float64](<#MinAggregation>)
- [func NewTransformReduceFunction\(transform func\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) map\[string\]\[\]float64, reduce func\(values map\[string\]\[\]float64\) \[\]float64\) func\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#NewTransformReduceFunction>)
- [func NextNonEmptyPopIndexFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \(int, bool\)](<#NextNonEmptyPopIndexFunction>)
- [func OtherPartitionPushFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \(\[\]float64, bool\)](<#OtherPartitionPushFunction>)
- [func OtherValuesFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, stateHistoryDepthIndex int\) \[\]float64](<#OtherValuesFunction>)
- [func ParamValuesPushFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \(\[\]float64, bool\)](<#ParamValuesPushFunction>)
- [func ParamsEventFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ParamsEventFunction>)
- [func ParamsTransform\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) map\[string\]\[\]float64](<#ParamsTransform>)
- [func PartitionEventFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#PartitionEventFunction>)
- [func PastDiscountedDataValuesFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, stateHistoryDepthIndex int\) \[\]float64](<#PastDiscountedDataValuesFunction>)
- [func PastDiscountedOtherValuesFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, stateHistoryDepthIndex int\) \[\]float64](<#PastDiscountedOtherValuesFunction>)
- [func PopFromOtherCollectionPushFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \(\[\]float64, bool\)](<#PopFromOtherCollectionPushFunction>)
- [func SumAggregation\(defaultValues \[\]float64, outputIndexByGroup map\[string\]int, groupings map\[string\]\[\]float64, weightings map\[string\]\[\]float64\) \[\]float64](<#SumAggregation>)
- [func SumReduce\(values map\[string\]\[\]float64\) \[\]float64](<#SumReduce>)
- [func UnitValueFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, stateHistoryDepthIndex int\) \[\]float64](<#UnitValueFunction>)
- [type ConstantValuesIteration](<#ConstantValuesIteration>)
  - [func \(c \*ConstantValuesIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#ConstantValuesIteration.Configure>)
  - [func \(c \*ConstantValuesIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ConstantValuesIteration.Iterate>)
- [type CopyValuesIteration](<#CopyValuesIteration>)
  - [func \(c \*CopyValuesIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#CopyValuesIteration.Configure>)
  - [func \(c \*CopyValuesIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#CopyValuesIteration.Iterate>)
- [type CumulativeIteration](<#CumulativeIteration>)
  - [func \(c \*CumulativeIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#CumulativeIteration.Configure>)
  - [func \(c \*CumulativeIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#CumulativeIteration.Iterate>)
- [type EmbeddedSimulationRunIteration](<#EmbeddedSimulationRunIteration>)
  - [func NewEmbeddedSimulationRunIteration\(settings \*simulator.Settings, implementations \*simulator.Implementations\) \*EmbeddedSimulationRunIteration](<#NewEmbeddedSimulationRunIteration>)
  - [func \(e \*EmbeddedSimulationRunIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#EmbeddedSimulationRunIteration.Configure>)
  - [func \(e \*EmbeddedSimulationRunIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#EmbeddedSimulationRunIteration.Iterate>)
- [type FromHistoryIteration](<#FromHistoryIteration>)
  - [func \(f \*FromHistoryIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#FromHistoryIteration.Configure>)
  - [func \(f \*FromHistoryIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#FromHistoryIteration.Iterate>)
  - [func \(f \*FromHistoryIteration\) UpdateMemory\(params \*simulator.Params, update StateMemoryUpdate\)](<#FromHistoryIteration.UpdateMemory>)
- [type FromHistoryTimestepFunction](<#FromHistoryTimestepFunction>)
  - [func \(f \*FromHistoryTimestepFunction\) NextIncrement\(timestepsHistory \*simulator.CumulativeTimestepsHistory\) float64](<#FromHistoryTimestepFunction.NextIncrement>)
- [type FromStorageIteration](<#FromStorageIteration>)
  - [func \(f \*FromStorageIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#FromStorageIteration.Configure>)
  - [func \(f \*FromStorageIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#FromStorageIteration.Iterate>)
- [type FromStorageTimestepFunction](<#FromStorageTimestepFunction>)
  - [func \(f \*FromStorageTimestepFunction\) NextIncrement\(timestepsHistory \*simulator.CumulativeTimestepsHistory\) float64](<#FromStorageTimestepFunction.NextIncrement>)
- [type NamedIndexedState](<#NamedIndexedState>)
- [type ParamValuesIteration](<#ParamValuesIteration>)
  - [func \(p \*ParamValuesIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#ParamValuesIteration.Configure>)
  - [func \(p \*ParamValuesIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ParamValuesIteration.Iterate>)
- [type SortingValues](<#SortingValues>)
  - [func OtherPartitionsPushAndSortFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \(SortingValues, bool\)](<#OtherPartitionsPushAndSortFunction>)
  - [func ParamValuesPushAndSortFunction\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \(SortingValues, bool\)](<#ParamValuesPushAndSortFunction>)
- [type StateMemoryIteration](<#StateMemoryIteration>)
- [type StateMemoryUpdate](<#StateMemoryUpdate>)
- [type ValuesChangingEventsIteration](<#ValuesChangingEventsIteration>)
  - [func \(v \*ValuesChangingEventsIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#ValuesChangingEventsIteration.Configure>)
  - [func \(v \*ValuesChangingEventsIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ValuesChangingEventsIteration.Iterate>)
- [type ValuesCollectionIteration](<#ValuesCollectionIteration>)
  - [func \(v \*ValuesCollectionIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#ValuesCollectionIteration.Configure>)
  - [func \(v \*ValuesCollectionIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ValuesCollectionIteration.Iterate>)
- [type ValuesFunctionIteration](<#ValuesFunctionIteration>)
  - [func \(v \*ValuesFunctionIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#ValuesFunctionIteration.Configure>)
  - [func \(v \*ValuesFunctionIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ValuesFunctionIteration.Iterate>)
- [type ValuesFunctionVectorCovarianceIteration](<#ValuesFunctionVectorCovarianceIteration>)
  - [func \(v \*ValuesFunctionVectorCovarianceIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#ValuesFunctionVectorCovarianceIteration.Configure>)
  - [func \(v \*ValuesFunctionVectorCovarianceIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ValuesFunctionVectorCovarianceIteration.Iterate>)
- [type ValuesFunctionVectorMeanIteration](<#ValuesFunctionVectorMeanIteration>)
  - [func \(v \*ValuesFunctionVectorMeanIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#ValuesFunctionVectorMeanIteration.Configure>)
  - [func \(v \*ValuesFunctionVectorMeanIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ValuesFunctionVectorMeanIteration.Iterate>)
- [type ValuesGroupedAggregationIteration](<#ValuesGroupedAggregationIteration>)
  - [func \(v \*ValuesGroupedAggregationIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#ValuesGroupedAggregationIteration.Configure>)
  - [func \(v \*ValuesGroupedAggregationIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ValuesGroupedAggregationIteration.Iterate>)
- [type ValuesSortingCollectionIteration](<#ValuesSortingCollectionIteration>)
  - [func \(v \*ValuesSortingCollectionIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#ValuesSortingCollectionIteration.Configure>)
  - [func \(v \*ValuesSortingCollectionIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ValuesSortingCollectionIteration.Iterate>)
- [type ValuesWeightedResamplingIteration](<#ValuesWeightedResamplingIteration>)
  - [func \(v \*ValuesWeightedResamplingIteration\) Configure\(partitionIndex int, settings \*simulator.Settings\)](<#ValuesWeightedResamplingIteration.Configure>)
  - [func \(v \*ValuesWeightedResamplingIteration\) Iterate\(params \*simulator.Params, partitionIndex int, stateHistories \[\]\*simulator.StateHistory, timestepsHistory \*simulator.CumulativeTimestepsHistory\) \[\]float64](<#ValuesWeightedResamplingIteration.Iterate>)


<a name="AppendFloatToKey"></a>

## func [AppendFloatToKey](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_grouped_aggregation.go#L103>)

```go
func AppendFloatToKey(key string, value float64, precision int) string
```

AppendFloatToKey appends a formatted float to a composite grouping key at a fixed precision.

<a name="CountAggregation"></a>

## func [CountAggregation](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_grouped_aggregation.go#L14-L19>)

```go
func CountAggregation(defaultValues []float64, outputIndexByGroup map[string]int, groupings map[string][]float64, weightings map[string][]float64) []float64
```

CountAggregation outputs, per group, the sum of weights \(i.e., a count when weights are all 1\).

<a name="DataValuesFunction"></a>

## func [DataValuesFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_mean.go#L122-L127>)

```go
func DataValuesFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, stateHistoryDepthIndex int) []float64
```

DataValuesFunction returns values from "data\_values\_partition", optionally subselecting indices.

<a name="DataValuesVarianceFunction"></a>

## func [DataValuesVarianceFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_mean.go#L95-L100>)

```go
func DataValuesVarianceFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, stateHistoryDepthIndex int) []float64
```

DataValuesVarianceFunction returns per\-index squared deviations from the provided "mean" for "data\_values\_partition".

<a name="FloatTupleToKey"></a>

## func [FloatTupleToKey](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_grouped_aggregation.go#L112>)

```go
func FloatTupleToKey(tuple []float64, precision int) string
```

FloatTupleToKey converts a vector to a composite key string at fixed precision, suitable for use as a map key.

<a name="MaxAggregation"></a>

## func [MaxAggregation](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_grouped_aggregation.go#L66-L71>)

```go
func MaxAggregation(defaultValues []float64, outputIndexByGroup map[string]int, groupings map[string][]float64, weightings map[string][]float64) []float64
```

MaxAggregation computes the maximum of weighted values per group.

<a name="MeanAggregation"></a>

## func [MeanAggregation](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_grouped_aggregation.go#L48-L53>)

```go
func MeanAggregation(defaultValues []float64, outputIndexByGroup map[string]int, groupings map[string][]float64, weightings map[string][]float64) []float64
```

MeanAggregation computes the weighted mean of values per group.

<a name="MinAggregation"></a>

## func [MinAggregation](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_grouped_aggregation.go#L84-L89>)

```go
func MinAggregation(defaultValues []float64, outputIndexByGroup map[string]int, groupings map[string][]float64, weightings map[string][]float64) []float64
```

MinAggregation computes the minimum of weighted values per group.

<a name="NewTransformReduceFunction"></a>

## func [NewTransformReduceFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function.go#L70-L83>)

```go
func NewTransformReduceFunction(transform func(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) map[string][]float64, reduce func(values map[string][]float64) []float64) func(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```

NewTransformReduceFunction returns a function that first transforms the provided simulation context into a map of vectors, then reduces those vectors into a single vector.

Usage hints:

- Compose transform/reduce pipelines to feed ValuesFunctionIteration.

<a name="NextNonEmptyPopIndexFunction"></a>

## func [NextNonEmptyPopIndexFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_collection.go#L13-L18>)

```go
func NextNonEmptyPopIndexFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) (int, bool)
```

NextNonEmptyPopIndexFunction scans the rolling collection for the next occupied slot \(index \> 0\) and returns its index for popping.

Usage hints:

- Index 0 is reserved for the most recently popped values.
- Configure "values\_state\_width" and "empty\_value" to mark empty slots.

<a name="OtherPartitionPushFunction"></a>

## func [OtherPartitionPushFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_collection.go#L37-L42>)

```go
func OtherPartitionPushFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) ([]float64, bool)
```

OtherPartitionPushFunction collects the latest values from another partition to push into the collection, subject to empty\_value.

Usage hints:

- Provide: "other\_partition" and "value\_indices".
- If the first element equals "empty\_value", the push is skipped.

<a name="OtherValuesFunction"></a>

## func [OtherValuesFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_mean.go#L76-L81>)

```go
func OtherValuesFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, stateHistoryDepthIndex int) []float64
```

OtherValuesFunction returns values from "other\_values\_partition", optionally subselecting indices.

<a name="ParamValuesPushFunction"></a>

## func [ParamValuesPushFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_collection.go#L82-L87>)

```go
func ParamValuesPushFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) ([]float64, bool)
```

ParamValuesPushFunction reads the next values directly from params under "next\_values\_push", subject to empty\_value.

Usage hints:

- Provide: "next\_values\_push" and "empty\_value".

<a name="ParamsEventFunction"></a>

## func [ParamsEventFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_changing_events.go#L26-L31>)

```go
func ParamsEventFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```

ParamsEventFunction emits an event value from the "event" params.

<a name="ParamsTransform"></a>

## func [ParamsTransform](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function.go#L39-L44>)

```go
func ParamsTransform(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) map[string][]float64
```

ParamsTransform is a convenience transform that returns the current params map. Useful as a building block for transform/reduce pipelines.

<a name="PartitionEventFunction"></a>

## func [PartitionEventFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_changing_events.go#L12-L17>)

```go
func PartitionEventFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```

PartitionEventFunction emits an event value from the latest state of another partition.

Usage hints:

- Provide: "event\_partition\_index" and "event\_state\_value\_index".

<a name="PastDiscountedDataValuesFunction"></a>

## func [PastDiscountedDataValuesFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_mean.go#L26-L31>)

```go
func PastDiscountedDataValuesFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, stateHistoryDepthIndex int) []float64
```

PastDiscountedDataValuesFunction reads from "data\_values\_partition" and applies an exponential discount factor raised to the history depth index. Useful with a kernel for a past\-discounted rolling mean.

<a name="PastDiscountedOtherValuesFunction"></a>

## func [PastDiscountedOtherValuesFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_mean.go#L50-L55>)

```go
func PastDiscountedOtherValuesFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, stateHistoryDepthIndex int) []float64
```

PastDiscountedOtherValuesFunction mirrors PastDiscountedDataValuesFunction for "other\_values\_partition", optionally subselecting indices.

<a name="PopFromOtherCollectionPushFunction"></a>

## func [PopFromOtherCollectionPushFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_collection.go#L60-L65>)

```go
func PopFromOtherCollectionPushFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) ([]float64, bool)
```

PopFromOtherCollectionPushFunction pulls the current popped values from another collection\-like partition and uses them as the next values to push.

Usage hints:

- Provide: "other\_partition" and "values\_state\_width".
- If the first element equals "empty\_value", the push is skipped.

<a name="SumAggregation"></a>

## func [SumAggregation](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_grouped_aggregation.go#L31-L36>)

```go
func SumAggregation(defaultValues []float64, outputIndexByGroup map[string]int, groupings map[string][]float64, weightings map[string][]float64) []float64
```

SumAggregation computes the weighted sum of values per group.

<a name="SumReduce"></a>

## func [SumReduce](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function.go#L53>)

```go
func SumReduce(values map[string][]float64) []float64
```

SumReduce reduces a map of equally sized vectors by summing them element\-wise into a single output vector.

Usage hints:

- Combine with NewTransformReduceFunction to compose dataflow operations.

<a name="UnitValueFunction"></a>

## func [UnitValueFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_mean.go#L14-L19>)

```go
func UnitValueFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, stateHistoryDepthIndex int) []float64
```

UnitValueFunction returns \[1\]. Combine with "without\_normalisation" to compute a kernel density \(sum of weights\) directly.

<a name="ConstantValuesIteration"></a>

## type [ConstantValuesIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/constant_values.go#L40-L41>)

ConstantValuesIteration leaves initial state values unchanged over time.

Usage hints:

- Useful for fixed baselines or as a placeholder partition.

```go
type ConstantValuesIteration struct {
}
```

<a name="ConstantValuesIteration.Configure"></a>

### func \(\*ConstantValuesIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/constant_values.go#L43-L46>)

```go
func (c *ConstantValuesIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="ConstantValuesIteration.Iterate"></a>

### func \(\*ConstantValuesIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/constant_values.go#L49-L54>)

```go
func (c *ConstantValuesIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="CopyValuesIteration"></a>

## type [CopyValuesIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/copy_values.go#L41-L42>)

CopyValuesIteration copies selected values from other partitions' latest states into its own state.

Usage hints:

- Provide params: "partitions" \(indices\) and "partition\_state\_values".

```go
type CopyValuesIteration struct {
}
```

<a name="CopyValuesIteration.Configure"></a>

### func \(\*CopyValuesIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/copy_values.go#L44-L47>)

```go
func (c *CopyValuesIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="CopyValuesIteration.Iterate"></a>

### func \(\*CopyValuesIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/copy_values.go#L50-L55>)

```go
func (c *CopyValuesIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="CumulativeIteration"></a>

## type [CumulativeIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/cumulative.go#L41-L43>)

CumulativeIteration accumulates a provided iteration's outputs over time.

Usage hints:

- Wrap another iteration to compute cumulative sums step\-by\-step.

```go
type CumulativeIteration struct {
    Iteration simulator.Iteration
}
```

<a name="CumulativeIteration.Configure"></a>

### func \(\*CumulativeIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/cumulative.go#L45-L48>)

```go
func (c *CumulativeIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="CumulativeIteration.Iterate"></a>

### func \(\*CumulativeIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/cumulative.go#L51-L56>)

```go
func (c *CumulativeIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="EmbeddedSimulationRunIteration"></a>

## type [EmbeddedSimulationRunIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/embedded_simulation_run.go#L76-L84>)

EmbeddedSimulationRunIteration runs a nested simulation to termination at each outer step.

Usage hints:

- Configure params on the outer iteration with keys of the form "\<innerPartitionName\>/\<param\_name\>" to forward into the inner simulation.
- Use "\<innerPartitionName\>/initial\_state\_from\_partition\_history" to seed inner initial states from an outer partition's history.
- Use "\<innerPartitionName\>/update\_from\_partition\_history" to stream outer histories into inner iterations that implement StateMemoryIteration.
- Optional "burn\_in\_steps" skips initial outer steps before running inner sim.

```go
type EmbeddedSimulationRunIteration struct {
    // contains filtered or unexported fields
}
```

<a name="NewEmbeddedSimulationRunIteration"></a>

### func [NewEmbeddedSimulationRunIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/embedded_simulation_run.go#L268-L271>)

```go
func NewEmbeddedSimulationRunIteration(settings *simulator.Settings, implementations *simulator.Implementations) *EmbeddedSimulationRunIteration
```

NewEmbeddedSimulationRunIteration constructs an embedded run iteration from prepared settings and implementations.

<a name="EmbeddedSimulationRunIteration.Configure"></a>

### func \(\*EmbeddedSimulationRunIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/embedded_simulation_run.go#L86-L89>)

```go
func (e *EmbeddedSimulationRunIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="EmbeddedSimulationRunIteration.Iterate"></a>

### func \(\*EmbeddedSimulationRunIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/embedded_simulation_run.go#L185-L190>)

```go
func (e *EmbeddedSimulationRunIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="FromHistoryIteration"></a>

## type [FromHistoryIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_history.go#L12-L15>)

FromHistoryIteration streams data from an in\-memory StateHistory.

Usage hints:

- Use with EmbeddedSimulationRun or analysis windows to replay data.
- Set Data to the source history; supports initial offset via InitStepsTaken.

```go
type FromHistoryIteration struct {
    Data           *simulator.StateHistory
    InitStepsTaken int
}
```

<a name="FromHistoryIteration.Configure"></a>

### func \(\*FromHistoryIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_history.go#L17-L20>)

```go
func (f *FromHistoryIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="FromHistoryIteration.Iterate"></a>

### func \(\*FromHistoryIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_history.go#L23-L28>)

```go
func (f *FromHistoryIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="FromHistoryIteration.UpdateMemory"></a>

### func \(\*FromHistoryIteration\) [UpdateMemory](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_history.go#L44-L47>)

```go
func (f *FromHistoryIteration) UpdateMemory(params *simulator.Params, update StateMemoryUpdate)
```



<a name="FromHistoryTimestepFunction"></a>

## type [FromHistoryTimestepFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_history.go#L56-L59>)

FromHistoryTimestepFunction streams timesteps from an in\-memory CumulativeTimestepsHistory.

Usage hints:

- Set Data to the source timestep series; supports initial offset via InitStepsTaken.

```go
type FromHistoryTimestepFunction struct {
    Data           *simulator.CumulativeTimestepsHistory
    InitStepsTaken int
}
```

<a name="FromHistoryTimestepFunction.NextIncrement"></a>

### func \(\*FromHistoryTimestepFunction\) [NextIncrement](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_history.go#L61-L63>)

```go
func (f *FromHistoryTimestepFunction) NextIncrement(timestepsHistory *simulator.CumulativeTimestepsHistory) float64
```



<a name="FromStorageIteration"></a>

## type [FromStorageIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_storage.go#L11-L14>)

FromStorageIteration streams data from an in\-memory \[\]\[\]float64.

Usage hints:

- Provide Data \(rows over time\); supports initial offset via InitStepsTaken.

```go
type FromStorageIteration struct {
    Data           [][]float64
    InitStepsTaken int
}
```

<a name="FromStorageIteration.Configure"></a>

### func \(\*FromStorageIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_storage.go#L16-L19>)

```go
func (f *FromStorageIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="FromStorageIteration.Iterate"></a>

### func \(\*FromStorageIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_storage.go#L22-L27>)

```go
func (f *FromStorageIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="FromStorageTimestepFunction"></a>

## type [FromStorageTimestepFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_storage.go#L44-L47>)

FromStorageTimestepFunction streams timesteps from an in\-memory \[\]float64.

Usage hints:

- Provide Data; supports initial offset via InitStepsTaken.

```go
type FromStorageTimestepFunction struct {
    Data           []float64
    InitStepsTaken int
}
```

<a name="FromStorageTimestepFunction.NextIncrement"></a>

### func \(\*FromStorageTimestepFunction\) [NextIncrement](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/from_storage.go#L49-L51>)

```go
func (f *FromStorageTimestepFunction) NextIncrement(timestepsHistory *simulator.CumulativeTimestepsHistory) float64
```



<a name="NamedIndexedState"></a>

## type [NamedIndexedState](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/embedded_simulation_run.go#L60-L63>)

NamedIndexedState pairs a partition's name/index with its state history. Useful for initialising inner histories from a chosen outer partition.

```go
type NamedIndexedState struct {
    NamedIndex simulator.NamedPartitionIndex
    History    *simulator.StateHistory
}
```

<a name="ParamValuesIteration"></a>

## type [ParamValuesIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/param_values.go#L12-L13>)

ParamValuesIteration writes the float param values under "param\_values" directly to the state.

Usage hints:

- Useful for injecting immediate parameter\-driven values.

```go
type ParamValuesIteration struct {
}
```

<a name="ParamValuesIteration.Configure"></a>

### func \(\*ParamValuesIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/param_values.go#L15-L18>)

```go
func (p *ParamValuesIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="ParamValuesIteration.Iterate"></a>

### func \(\*ParamValuesIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/param_values.go#L21-L26>)

```go
func (p *ParamValuesIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="SortingValues"></a>

## type [SortingValues](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_sorting_collection.go#L8-L11>)

SortingValues encapsulates a new entry to add to the sorting collection.

```go
type SortingValues struct {
    SortBy float64
    Values []float64
}
```

<a name="OtherPartitionsPushAndSortFunction"></a>

### func [OtherPartitionsPushAndSortFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_sorting_collection.go#L19-L24>)

```go
func OtherPartitionsPushAndSortFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) (SortingValues, bool)
```

OtherPartitionsPushAndSortFunction retrieves values from one partition and sorts by another partition's value.

Usage hints:

- Provide: "other\_partition", "value\_indices", "other\_partition\_sort\_by", and "value\_index\_sort\_by". Skip push if first value equals "empty\_value".

<a name="ParamValuesPushAndSortFunction"></a>

### func [ParamValuesPushAndSortFunction](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_sorting_collection.go#L45-L50>)

```go
func ParamValuesPushAndSortFunction(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) (SortingValues, bool)
```

ParamValuesPushAndSortFunction uses params for both values and sort key.

Usage hints:

- Provide: "next\_values\_push", "empty\_value", and "next\_values\_sort\_by".

<a name="StateMemoryIteration"></a>

## type [StateMemoryIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/embedded_simulation_run.go#L54-L56>)

StateMemoryIteration marks iterations that can receive state/time from a parent simulation and store it for later use.

```go
type StateMemoryIteration interface {
    UpdateMemory(params *simulator.Params, update StateMemoryUpdate)
}
```

<a name="StateMemoryUpdate"></a>

## type [StateMemoryUpdate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/embedded_simulation_run.go#L46-L50>)

StateMemoryUpdate carries a named partition's state and timestep history from an outer simulation into an inner \(embedded\) simulation.

Usage hints:

- Used by iterations implementing StateMemoryIteration to receive context.
- Set Name to the outer partition name for disambiguation.

```go
type StateMemoryUpdate struct {
    Name             string
    StateHistory     *simulator.StateHistory
    TimestepsHistory *simulator.CumulativeTimestepsHistory
}
```

<a name="ValuesChangingEventsIteration"></a>

## type [ValuesChangingEventsIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_changing_events.go#L42-L45>)

ValuesChangingEventsIteration calls and outputs from an iteration in the map keyed by an event. If no event key matches, it returns previous values or optional "default\_values".

Usage hints:

- Set EventIteration to produce the event key; provide IterationByEvent map.
- Optional: set "default\_values" to override fallback behaviour.

```go
type ValuesChangingEventsIteration struct {
    EventIteration   simulator.Iteration
    IterationByEvent map[float64]simulator.Iteration
}
```

<a name="ValuesChangingEventsIteration.Configure"></a>

### func \(\*ValuesChangingEventsIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_changing_events.go#L47-L50>)

```go
func (v *ValuesChangingEventsIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="ValuesChangingEventsIteration.Iterate"></a>

### func \(\*ValuesChangingEventsIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_changing_events.go#L57-L62>)

```go
func (v *ValuesChangingEventsIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="ValuesCollectionIteration"></a>

## type [ValuesCollectionIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_collection.go#L102-L115>)

ValuesCollectionIteration maintains a fixed\-width rolling collection of value vectors.

Usage hints:

- Provide: "values\_state\_width" and "empty\_value" for sentinel handling.
- Set Push to define how new values are appended; set PopIndex to surface an existing entry into index 0 and clear that slot.

```go
type ValuesCollectionIteration struct {
    PopIndex func(
        params *simulator.Params,
        partitionIndex int,
        stateHistories []*simulator.StateHistory,
        timestepsHistory *simulator.CumulativeTimestepsHistory,
    ) (int, bool)
    Push func(
        params *simulator.Params,
        partitionIndex int,
        stateHistories []*simulator.StateHistory,
        timestepsHistory *simulator.CumulativeTimestepsHistory,
    ) ([]float64, bool)
}
```

<a name="ValuesCollectionIteration.Configure"></a>

### func \(\*ValuesCollectionIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_collection.go#L117-L120>)

```go
func (v *ValuesCollectionIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="ValuesCollectionIteration.Iterate"></a>

### func \(\*ValuesCollectionIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_collection.go#L123-L128>)

```go
func (v *ValuesCollectionIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="ValuesFunctionIteration"></a>

## type [ValuesFunctionIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function.go#L163-L170>)

ValuesFunctionIteration provides a flexible way to compute derived values from simulation state and parameters using user\-defined functions.

This iteration type allows for custom computation logic within simulations, enabling feature engineering, data transformation, and complex derived value calculations. It's particularly useful for creating custom aggregation functions, feature extraction, and data preprocessing.

Design Philosophy: The function\-based approach emphasizes composition and reusability. By providing a pure function interface, this iteration enables:

- Stateless computation \(no side effects\)
- Easy testing and validation
- Composition with other iteration types
- Reusable computation logic across simulations

Function Signature: The Function field must implement a pure mapping from simulation context to output values. It receives:

- params: Current simulation parameters
- partitionIndex: Index of the current partition
- stateHistories: All partition state histories
- timestepsHistory: Time and timestep information

And returns a slice of float64 values representing the computed output.

Applications:

- Feature engineering: Compute derived features from raw simulation data
- Data transformation: Apply mathematical transformations to state values
- Custom aggregations: Implement specialized aggregation logic
- Parameter synthesis: Combine multiple parameters into derived values
- Event detection: Compute indicators for significant events

Example:

```
iteration := &ValuesFunctionIteration{
    Function: func(params *simulator.Params, partitionIndex int,
                   stateHistories []*simulator.StateHistory,
                   timestepsHistory *simulator.CumulativeTimestepsHistory) []float64 {
        // Extract current state from first partition
        currentState := stateHistories[0].Values.RawRowView(0)

        // Compute derived feature: moving average
        if len(currentState) >= 2 {
            return []float64{(currentState[0] + currentState[1]) / 2.0}
        }
        return []float64{0.0}
    },
}
```

Performance Considerations:

- Function is called once per simulation step
- Avoid expensive computations in the function body
- Consider caching for repeated calculations
- Memory allocations should be minimized

API Stability:

- This interface is stable and will not change in future versions
- Function signature is compatible across all stochadex versions

Related Types:

- See NewTransformReduceFunction for composed transform\-reduce operations
- See ParamsTransform for parameter extraction utilities
- See SumReduce for simple reduction operations

```go
type ValuesFunctionIteration struct {
    Function func(
        params *simulator.Params,
        partitionIndex int,
        stateHistories []*simulator.StateHistory,
        timestepsHistory *simulator.CumulativeTimestepsHistory,
    ) []float64
}
```

<a name="ValuesFunctionIteration.Configure"></a>

### func \(\*ValuesFunctionIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function.go#L172-L175>)

```go
func (v *ValuesFunctionIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="ValuesFunctionIteration.Iterate"></a>

### func \(\*ValuesFunctionIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function.go#L178-L183>)

```go
func (v *ValuesFunctionIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="ValuesFunctionVectorCovarianceIteration"></a>

## type [ValuesFunctionVectorCovarianceIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_covariance.go#L21-L29>)

ValuesFunctionVectorCovarianceIteration computes a kernel\-weighted rolling covariance of a function over historical values and times.

Usage hints:

- Provide Function that accepts a history index \(\-1 for latest\) and returns a vector matching the partition state width.
- Set Kernel and related params \(e.g., bandwidth, discounting\).
- Requires a "mean" param vector for centring.
- The upper\-triangular covariance is returned flattened.

```go
type ValuesFunctionVectorCovarianceIteration struct {
    Function func(
        params *simulator.Params,
        partitionIndex int,
        stateHistories []*simulator.StateHistory,
        stateHistoryDepthIndex int,
    ) []float64
    Kernel kernels.IntegrationKernel
}
```

<a name="ValuesFunctionVectorCovarianceIteration.Configure"></a>

### func \(\*ValuesFunctionVectorCovarianceIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_covariance.go#L31-L34>)

```go
func (v *ValuesFunctionVectorCovarianceIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="ValuesFunctionVectorCovarianceIteration.Iterate"></a>

### func \(\*ValuesFunctionVectorCovarianceIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_covariance.go#L38-L43>)

```go
func (v *ValuesFunctionVectorCovarianceIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="ValuesFunctionVectorMeanIteration"></a>

## type [ValuesFunctionVectorMeanIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_mean.go#L152-L160>)

ValuesFunctionVectorMeanIteration computes a kernel\-weighted rolling mean of a function over historical values and times.

Usage hints:

- Provide Function that accepts a history index \(\-1 for latest\) and returns a vector matching the partition state width.
- Set Kernel and related params \(e.g., discount factors, bandwidth, etc.\).
- Use "without\_normalisation" to return the weighted sum rather than mean; "subtract\_from\_normalisation" adjusts the normaliser if needed.

```go
type ValuesFunctionVectorMeanIteration struct {
    Function func(
        params *simulator.Params,
        partitionIndex int,
        stateHistories []*simulator.StateHistory,
        stateHistoryDepthIndex int,
    ) []float64
    Kernel kernels.IntegrationKernel
}
```

<a name="ValuesFunctionVectorMeanIteration.Configure"></a>

### func \(\*ValuesFunctionVectorMeanIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_mean.go#L162-L165>)

```go
func (v *ValuesFunctionVectorMeanIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="ValuesFunctionVectorMeanIteration.Iterate"></a>

### func \(\*ValuesFunctionVectorMeanIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_function_vector_mean.go#L169-L174>)

```go
func (v *ValuesFunctionVectorMeanIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="ValuesGroupedAggregationIteration"></a>

## type [ValuesGroupedAggregationIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_grouped_aggregation.go#L130-L141>)

ValuesGroupedAggregationIteration collects historical values and weights into grouping buckets \(defined by tupled grouping series\) and applies a caller\-provided aggregation per bucket.

Usage hints:

- Configure accepted group tuples via params: "accepted\_value\_group\_tupindex\_k".
- Provide grouping source partitions/indices via "grouping\_partition\_tupindex\_k" and "grouping\_value\_indices\_tupindex\_k".
- Provide the state series via "state\_partition" and "state\_value\_indices".
- Set Kernel and precision \("float\_precision"\); optionally set "default\_values".

```go
type ValuesGroupedAggregationIteration struct {
    Aggregation func(
        defaultValues []float64,
        outputIndexByGroup map[string]int,
        groupings map[string][]float64,
        weightings map[string][]float64,
    ) []float64
    Kernel kernels.IntegrationKernel
    // contains filtered or unexported fields
}
```

<a name="ValuesGroupedAggregationIteration.Configure"></a>

### func \(\*ValuesGroupedAggregationIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_grouped_aggregation.go#L143-L146>)

```go
func (v *ValuesGroupedAggregationIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="ValuesGroupedAggregationIteration.Iterate"></a>

### func \(\*ValuesGroupedAggregationIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_grouped_aggregation.go#L171-L176>)

```go
func (v *ValuesGroupedAggregationIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="ValuesSortingCollectionIteration"></a>

## type [ValuesSortingCollectionIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_sorting_collection.go#L66-L73>)

ValuesSortingCollectionIteration maintains a sorted collection of entries.

Usage hints:

- Provide: "values\_state\_width" \(entry width minus 1 for sort key\) and "empty\_value" sentinel. Set PushAndSort to define insertion behaviour.

```go
type ValuesSortingCollectionIteration struct {
    PushAndSort func(
        params *simulator.Params,
        partitionIndex int,
        stateHistories []*simulator.StateHistory,
        timestepsHistory *simulator.CumulativeTimestepsHistory,
    ) (SortingValues, bool)
}
```

<a name="ValuesSortingCollectionIteration.Configure"></a>

### func \(\*ValuesSortingCollectionIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_sorting_collection.go#L75-L78>)

```go
func (v *ValuesSortingCollectionIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="ValuesSortingCollectionIteration.Iterate"></a>

### func \(\*ValuesSortingCollectionIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_sorting_collection.go#L81-L86>)

```go
func (v *ValuesSortingCollectionIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



<a name="ValuesWeightedResamplingIteration"></a>

## type [ValuesWeightedResamplingIteration](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_weighted_resampling.go#L20-L23>)

ValuesWeightedResamplingIteration resamples historical values from other partitions according to provided \(optionally discounted\) weights.

Usage hints:

- Provide: "log\_weight\_partitions" \(and optional "log\_weight\_indices"\).
- Provide: "data\_values\_partitions" to choose which values to resample.
- Use "past\_discounting\_factor" to downweight older history \(exponential\).

```go
type ValuesWeightedResamplingIteration struct {
    Src rand.Source
    // contains filtered or unexported fields
}
```

<a name="ValuesWeightedResamplingIteration.Configure"></a>

### func \(\*ValuesWeightedResamplingIteration\) [Configure](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_weighted_resampling.go#L25-L28>)

```go
func (v *ValuesWeightedResamplingIteration) Configure(partitionIndex int, settings *simulator.Settings)
```



<a name="ValuesWeightedResamplingIteration.Iterate"></a>

### func \(\*ValuesWeightedResamplingIteration\) [Iterate](<https://github.com/umbralcalc/stochadex/blob/main/pkg/general/values_weighted_resampling.go#L44-L49>)

```go
func (v *ValuesWeightedResamplingIteration) Iterate(params *simulator.Params, partitionIndex int, stateHistories []*simulator.StateHistory, timestepsHistory *simulator.CumulativeTimestepsHistory) []float64
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
